<%= form_for(user) do |f| %>

    <div class="row">
      <div class="col-xs-5 col-xs-offset-5">
        <div class="text-center">
          <div id="userimgpre" class="" style="width: 100px; height: 100px; border: 2px solid; border-radius: 50%; margin-bottom: 10px;">
            <%= avatar_for(user, "img_prev","") %>
          </div>
        </div>
        <div class="fileinput fileinput-new" data-provides="fileinput" style="margin-bottom: 25px;">
          <span class="btn btn-primary btn-file m-r-10 waves-effect waves-button">
                <span class="fileinput-new">Select file</span>
                <span class="fileinput-exists">Change</span>
                <input type="hidden"><%= f.file_field :avatar, :onchange => "readURL(this)" %>
            </span>
          <span class="fileinput-filename"></span>
          <a href="#" class="close fileinput-exists" data-dismiss="fileinput">×</a>
        </div>
      </div>
    </div>

      <div class="col-md-8">
        <div class="form-group fg-float
        <% if user.errors[:email].any? %> <%= "has-error has-feedback" %>
        <% end %>">
          <div class="fg-line">
            <%= f.email_field :email, class: 'form-control input-sm' %>
          </div>
          <label class="fg-label">Email</label>
          <% user.errors[:email].each do |message| %>
              <li>
                <footer><%= message %></footer>
              </li>
          <% end %>
        </div>
      </div>


      <div class="col-md-8">
        <div class="form-group fg-float
      <% if user.errors[:password].any? %> <%= "has-error has-feedback" %>
      <% end %>">
          <div class="fg-line">
            <%= f.password_field :password, class: 'form-control input-sm' %>
          </div>
          <label class="fg-label">Contraseña</label>
          <% user.errors[:password].each do |message| %>
              <li>
                <footer><%= message %></footer>
              </li>
          <% end %>
        </div>
      </div>


      <div class="col-md-8">
        <div class="form-group fg-float
      <% if user.errors[:username].any? %> <%= "has-error has-feedback" %>
      <% end %>">
          <div class="fg-line">
            <%= f.text_field :username, class: 'form-control input-sm' %>
          </div>
          <label class="fg-label">Usuario</label>
          <% user.errors[:username].each do |message| %>
              <li>
                <footer><%= message %></footer>
              </li>
          <% end %>
        </div>
      </div>


      <div class="col-md-8">
        <div class="form-group fg-float
      <% if user.errors[:first_name].any? %> <%= "has-error has-feedback" %>
      <% end %>">
          <div class="fg-line">
            <%= f.text_field :first_name, class: 'form-control input-sm' %>
          </div>
          <label class="fg-label">Nombre</label>
          <% user.errors[:first_name].each do |message| %>
              <li>
                <footer><%= message %></footer>
              </li>
          <% end %>
        </div>
      </div>


      <div class="col-md-8">
        <div class="form-group fg-float
      <% if user.errors[:last_name].any? %> <%= "has-error has-feedback" %>
      <% end %>">
          <div class="fg-line">
            <%= f.text_field :last_name, class: 'form-control input-sm' %>
          </div>
          <label class="fg-label">Apellido</label>
          <% user.errors[:last_name].each do |message| %>
              <li>
                <footer><%= message %></footer>
              </li>
          <% end %>
        </div>
      </div>

    <% if user.email != 'admin@gmail.com' && current_user.is_admin? %>

          <div class="col-md-8 col-xs-offset-6">
            <div class="form-group fg-float
      <% if user.errors[:permission_level].any? %> <%= "has-error has-feedback" %>
      <% end %>">
              <div class="fg-line">
                <%= select_tag(:permission_level, options_for_select([['Invitado', 1], ['Editor', 2], ['Administrador',3]], user.permission_level), class: 'form-control') %>
              </div>
              <label class="fg-label">Rol</label>
              <% user.errors[:permission_level].each do |message| %>
                  <li>
                    <footer><%= message %></footer>
                  </li>
              <% end %>
            </div>
          </div>



    <% end %>

      <div class="col-xs-4">
        <div class="form-group fg-float">
          <%= f.submit "Save", class: "btn btn-default btn-success pull-left" %>
        </div>
      </div>

<% end %>
<script>

      function readURL(input)
  {
      if (input.files && input.files[0]) {
          var reader = new FileReader();
          console.log(reader);
          reader.onload = function (e) {
              console.log("loaded");
              $('#img_prev')
                  .attr('src', e.target.result)
                  .width('100%')
                  .height('100%');
          };

          reader.readAsDataURL(input.files[0]);
      }
  }

</script>



